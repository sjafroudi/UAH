<!DOCTYPE html>
<html>

<!-- Basemap menu -->
<div id="menu" class="menu">
  <input id="sjafroudi/ckkebwmd4094i17rvfpitb0pz" class="checkbox" type="radio" name="rtoggle" value="light" checked="checked">
  <label for="ckkebwmd4094i17rvfpitb0pz">default</label>
  <input id="sjafroudi/ckr71osae2y9a18preipzbwx0" class="checkbox" type="radio" name="rtoggle" value="streets">
  <label for="ckr71osae2y9a18preipzbwx0">streets</label>
  <input id="mapbox/satellite-v9" class="checkbox" type="radio" name="rtoggle" value="satellite">
  <label for="satellite-v9">satellite</label>
</div>

<!-- Basemap menu -->
<div id="note">
  <p>Click on a point<br>to learn more</p>
</div>

<!-- Side navigation -->
<div id="sidenav" class="sidenav">
  <h href="#">Urban Agricultural Heritage<br>Interactive Atlas</h>
  
  <div id="sidenavFact" class="sidenavFact">
    <span id="close" class="close" onclick="closeFunction()">x</span>
  </div>
  
  <!-- Search bar -->
  <a href="#">
    <div class="wrapper">
      <img class="search-icon" src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDU2Ljk2NiA1Ni45NjYiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDU2Ljk2NiA1Ni45NjY7IiB4bWw6c3BhY2U9InByZXNlcnZlIiB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4Ij4KPHBhdGggZD0iTTU1LjE0Niw1MS44ODdMNDEuNTg4LDM3Ljc4NmMzLjQ4Ni00LjE0NCw1LjM5Ni05LjM1OCw1LjM5Ni0xNC43ODZjMC0xMi42ODItMTAuMzE4LTIzLTIzLTIzcy0yMywxMC4zMTgtMjMsMjMgIHMxMC4zMTgsMjMsMjMsMjNjNC43NjEsMCw5LjI5OC0xLjQzNiwxMy4xNzctNC4xNjJsMTMuNjYxLDE0LjIwOGMwLjU3MSwwLjU5MywxLjMzOSwwLjkyLDIuMTYyLDAuOTIgIGMwLjc3OSwwLDEuNTE4LTAuMjk3LDIuMDc5LTAuODM3QzU2LjI1NSw1NC45ODIsNTYuMjkzLDUzLjA4LDU1LjE0Niw1MS44ODd6IE0yMy45ODQsNmM5LjM3NCwwLDE3LDcuNjI2LDE3LDE3cy03LjYyNiwxNy0xNywxNyAgcy0xNy03LjYyNi0xNy0xN1MxNC42MSw2LDIzLjk4NCw2eiIgZmlsbD0iIzAwMDAwMCIvPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K" />
      <input class="search" placeholder="Search" type="text" >
      <img class="clear-icon" src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDUxLjk3NiA1MS45NzYiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxLjk3NiA1MS45NzY7IiB4bWw6c3BhY2U9InByZXNlcnZlIiB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4Ij4KPGc+Cgk8cGF0aCBkPSJNNDQuMzczLDcuNjAzYy0xMC4xMzctMTAuMTM3LTI2LjYzMi0xMC4xMzgtMzYuNzcsMGMtMTAuMTM4LDEwLjEzOC0xMC4xMzcsMjYuNjMyLDAsMzYuNzdzMjYuNjMyLDEwLjEzOCwzNi43NywwICAgQzU0LjUxLDM0LjIzNSw1NC41MSwxNy43NCw0NC4zNzMsNy42MDN6IE0zNi4yNDEsMzYuMjQxYy0wLjc4MSwwLjc4MS0yLjA0NywwLjc4MS0yLjgyOCwwbC03LjQyNS03LjQyNWwtNy43NzgsNy43NzggICBjLTAuNzgxLDAuNzgxLTIuMDQ3LDAuNzgxLTIuODI4LDBjLTAuNzgxLTAuNzgxLTAuNzgxLTIuMDQ3LDAtMi44MjhsNy43NzgtNy43NzhsLTcuNDI1LTcuNDI1Yy0wLjc4MS0wLjc4MS0wLjc4MS0yLjA0OCwwLTIuODI4ICAgYzAuNzgxLTAuNzgxLDIuMDQ3LTAuNzgxLDIuODI4LDBsNy40MjUsNy40MjVsNy4wNzEtNy4wNzFjMC43ODEtMC43ODEsMi4wNDctMC43ODEsMi44MjgsMGMwLjc4MSwwLjc4MSwwLjc4MSwyLjA0NywwLDIuODI4ICAgbC03LjA3MSw3LjA3MWw3LjQyNSw3LjQyNUMzNy4wMjIsMzQuMTk0LDM3LjAyMiwzNS40NiwzNi4yNDEsMzYuMjQxeiIgZmlsbD0iIzAwMDAwMCIvPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo=" />
    </div>
  </a>
  
  <!-- Catalogue -->
  <button class="button button1">Case Study Catalogue
    <i class="fa fa-caret-down"></i></button>
    <div class="dropdown-container" id="catalogue">
      
      <ab href="#">North America</ab>
      <c href="#" class="siteList na" value="Central Experimental Farm" id="Central Experimental Farm" onclick="flyToSiteCentral()">Central Experimental Farm</c>
      <c href="#" class="siteList na" value="Dowling School Victory Garden" id="Dowling School Victory Garden" onclick="flyToSiteDowling()">Dowling School Victory Garden</c>
      <c href="#" class="siteList na" value="Fenway Victory Gardens" id="Fenway Victory Gardens" onclick="flyToSiteFenway()">Fenway Victory Gardens</c>
      <c href="#" class="siteList na" value="Five Acre Farm" id="Five Acre Farm" onclick="flyToSiteFive()">Five Acre Farm</c>
      <c href="#" class="siteList" value="Glamorgan Farm" id="Glamorgan Farm" onclick="flyToSiteGlamorgan()">Glamorgan Farm</c>
      <c href="#" class="siteList" value="London Heritage Farm" id="London Heritage Farm" onclick="flyToSiteLondon()">London Heritage Farm</c>
      <c href="#" class="siteList" value="Newman Farm" id="Newman Farm" onclick="flyToSiteNewman()">Newman Farm</c>
      <c href="#" class="siteList" value="UBC Farm" id="UBC Farm" onclick="flyToSiteUBC()">UBC Farm</c>
      <ab href="#">Central America</ab>
      <c href="#">Agave</c>
      <c href="#" class="siteList UNFAOGIAHS CommercialFarm LocalFoodFarms FamilyGardens" value="Chinampas" id="Chinampas" onclick="flyToSiteChinampas()">Chinampas</c>
      <c href="#" class="siteList" id="El Pilar Forest Garden" onclick="flyToSite()">El Pilar Forest Garden</c>
      <c href="#">Metepantles</c>
      <c href="#">Organoponicos</c>
      <c href="#">Porcicultura Cienfuegos</c>
      <ab href="#">South America</ab>
      <c href="#">Fazenda Bananal</c>
      <c href="#">Homegardens, Sao Luis</c>
      <c href="#">Pairumani Model Farm</c>
      <c href="#">Porcicultura Lurigancho-Chosica</c>
      <c href="#">Porcicultura Montevideo</c>
      <c href="#">Porcicultura Porto Alegre</c>
      <ab href="#">Europe</ab>
      <c href="#" class="siteList" value="Bude Farm" id="Bude Farm" onclick="flyToSiteBude()">Bude Farm</c>
      <c href="#" class="siteList" value="Can Masdeu" id="Can Masdeu" onclick="flyToSiteCan()">Can Masdeu</c>
      <c href="#" class="siteList" id="Jucker Farm" onclick="flyToSiteJucker()">Jucker Farm</c>
      <c href="#" class="siteList" id="La Huerta de Valencia" onclick="flyToSiteHuerta()">La Huerta de Valencia</c>
      <c href="#">San Francesco Forest</c>
      <c href="#">Tenuta del Cavaliere</c>
      <c href="#" class="siteList" id="Via Integration" onclick="flyToSiteVia()">Via Integration</c>
      <c href="#" class="siteList" id="Knoblauchsland" onclick="flyToSiteKnoblauchsland()">Knoblauchsland</c>
      <c href="#" class="siteList" id="Sant Erasmo" onclick="flyToSiteSant()">Sant Erasmo</c>
      <c href="#">Amiens/Bourges</c>
      <c href="#">Vega de Granada</c>
      <c href="#">Peachwalls of Montreuil</c>
      <c href="#" class="siteList" id="Dachas (Johannesburg)" onclick="flyToSiteDachas()">Dachas (Johannesburg)</c>
      <c href="#">Palmeral of Elche/Orihuela</c>
      <ab href="#">Middle East and North Africa</ab>
      <c href="#">Cairo Dairy Farms</c>
      <c href="#">Kuttanad Below Sea Level Farming System</c>
      <c href="#">Qanat-based Saffron Farming System</c>
      <ab href="#">Sub-Saharan Africa</ab>
      <c href="#">Jos Plateau Vegetable Farming</c>
      <c href="#">Little Akaki</c>
      <c href="#">Oranjezicht City Farm</c>
      <c href="#">Philippi Horticultural Area</c>
      <c href="#">Vlei Agriculture Harare</c>
      <c href="#">VOC Vegetable Garden</c>
      <ab href="#">South & Southeast Asia</ab>
      <c href="#">Home Gardens Hanoi</c>
    </div>
    
    
    <!-- Filter -->
    <button class="button button1">Filters
      <i class="fa fa-caret-down"></i></button>
      <div class="dropdown-container">
        <f href="#">Heritage Status:</f>
        <t href="#">
          <!--<input type="checkbox" id="status" name="status" value="all" class="filter">-->
          <!--<label for="status"> All</label><br>-->
          <input type="checkbox" id="status" name="status" value="UNFAOGIAHS" class="filter">
          <label for="status1"> UN FAO GIAHS</label><br>
          <input type="checkbox" id="status" name="status" value="UNFAOGIAHSPending" class="filter">
          <label for="status2"> UN FAO GIAHS Pending</label><br>
          <button class="button button2">more heritage status filters &emsp; <i class="fa fa-caret-down"></i></button>
          <div class="dropdown-container">
            <input type="checkbox" id="status" name="status" value="UNESCO" class="filter">
            <label for="status3"> UNESCO Heritage Site</label><br>
            <input type="checkbox" id="status" name="status" value="UNESCOHeritageSite" class="filter">
            <label for="status4"> UNESCO Heritage Site Pending</label><br>
            <input type="checkbox" id="status" name="status" value="NationalHistoricSite" class="filter">
            <label for="status5"> National Historic Site</label><br>
            <input type="checkbox" id="status" name="status" value="ProvincialHistoricSite" class="filter">
            <label for="status6"> Provincial Historic Site</label><br>
            <input type="checkbox" id="status" name="status" value="LocalHistoricSite" class="filter">
            <label for="status7"> Local Historic Site</label><br>
            <input type="checkbox" id="status" name="status" value="na" class="filter">
            <label for="status8"> n/a</label><br>
          </div>
        </t>
        
        <f href="#">Urban Agriculture Type:</f>
        <t href="#">
          <!--<input type="checkbox" id="uatype" name="uatype" value="all">-->
          <!--<label for="uatype"> All</label><br>-->
          <input type="checkbox" id="uatype" name="uatype" value="Community Garden" class="filter">
          <label for="uatype1"> Community Garden</label><br>
          <input type="checkbox" id="uatype1" name="uatype" value="Commercial Farm" class="filter">
          <label for="uatype2"> Commercial Farm</label><br>
          <button class="button button2">more urban agriculture type filters &emsp; <i class="fa fa-caret-down"></i></button>
          <div class="dropdown-container">
            <input type="checkbox" id="uatype" name="uatype" value="Educational Garden">
            <label for="uatype3"> Educational Garden</label><br>
            <input type="checkbox" id="uatype" name="uatype" value="Allotment Garden">
            <label for="uatype5"> Allotment Garden</label><br>
            <input type="checkbox" id="uatype" name="uatype" value="Squatter Gardens">
            <label for="uatype5"> Squatter Gardens</label><br>
            <input type="checkbox" id="uatype" name="uatype" value="Leisure and Educational Garden">
            <label for="uatype6"> Leisure and Educational Garden</label><br>
            <input type="checkbox" id="uatype" name="uatype" value="Therapeutic Farm">
            <label for="uatype7"> Therapeutic Farm</label><br>
            <input type="checkbox" id="uatype" name="uatype" value="Social Farm">
            <label for="uatype8"> Social Farm</label><br>
            <input type="checkbox" id="uatype" name="uatype" value="Cultural Heritage Farm">
            <label for="uatype9"> Cultural Heritage Farm</label><br>
            <input type="checkbox" id="uatype" name="uatype" value="Experimental Farm">
            <label for="uatype10"> Experimental Farm</label><br>
            <input type="checkbox" id="uatype" name="uatype" value="Local Food Farm">
            <label for="uatype11"> Local Food Farm</label><br>
            <input type="checkbox" id="uatype" name="uatype" value="Environmental Farm">
            <label for="uatype12"> Environmental Farm</label><br>
          </div>
        </t>
        <f href="#">Generalized Risks:</f>
        <t href="#">
          <!--<input type="checkbox" id="risk" name="risk" value="all">-->
          <!--<label for="risk"> All</label><br>-->
          <input type="checkbox" id="risk" name="risk" value="Environmental" class="filter">
          <label for="risk1"> Environmental</label><br>
          <input type="checkbox" id="risk" name="risk" value="Economic" class="filter">
          <label for="risk2"> Economic</label><br>
          <button class="button button2">more generalized risk filters &emsp; <i class="fa fa-caret-down"></i></button>
          <div class="dropdown-container">
            <input type="checkbox" id="risk" name="risk" value="Land Use and Ownership">
            <label for="risk3"> Land Use and Ownership</label><br>
          </div>
        </t>
        <f href="#">Risks to System:</f>
        <t href="#">
          <!--<input type="checkbox" id="risk2sys" name="risk2sys" value="all">-->
          <!--<label for="risk2sys"> All</label><br>-->
          <input type="checkbox" id="risk2sys1" name="risk2sys1" value="Flooding" class="filter">
          <label for="risk2sys1"> Flooding</label><br>
          <input type="checkbox" id="risk2sys2" name="risk2sys2" value="Drought" class="filter">
          <label for="risk2sys2"> Drought</label><br>
          <button class="button button2">more risks to system filters &emsp; <i class="fa fa-caret-down"></i></button>
          <div class="dropdown-container">
            <input type="checkbox" id="risk2sys3" name="risk2sys3" value="Pollution">
            <label for="risk2sys3"> Pollution</label><br>
            <input type="checkbox" id="risk2sys4" name="risk2sys4" value="Fertilizers/Pesticides">
            <label for="risk2sys4"> Fertilizers/Pesticides</label><br>
            <input type="checkbox" id="risk2sys5" name="risk2sys5" value="Global Warming">
            <label for="risk2sys5"> Global Warming</label><br>
            <input type="checkbox" id="risk2sys6" name="risk2sys6" value="Water Management">
            <label for="risk2sys6"> Water Management</label><br>
            <input type="checkbox" id="risk2sys7" name="risk2sys7" value="Soil Quality">
            <label for="risk2sys7"> Soil Quality</label><br>
            <input type="checkbox" id="risk2sys8" name="risk2sys8" value="Pests">
            <label for="risk2sys8"> Pests</label><br>
            <input type="checkbox" id="risk2sys9" name="risk2sys9" value="n/a">
            <label for="risk2sys9"> n/a</label><br>
          </div>
        </t>
        <f href="#">Land Use System:</f>
        <t href="#">
          <!--<input type="checkbox" id="land" name="land" value="all">-->
          <!--<label for="land"> All</label><br>-->
          <input type="checkbox" id="land1" name="land1" value="Field Cultivation" class="filter">
          <label for="land1"> Field Cultivation</label><br>
          <input type="checkbox" id="land2" name="land2" value="Individual Plots" class="filter">
          <label for="land2"> Individual Plots</label><br>
          <button class="button button2">more land use system filters &emsp; <i class="fa fa-caret-down"></i></button>
          <div class="dropdown-container">
            <input type="checkbox" id="land3" name="land3" value="Family Plots">
            <label for="land3"> Family Plots</label><br>
            <input type="checkbox" id="land4" name="land4" value="Orchard">
            <label for="land4"> Orchard</label><br>
            <input type="checkbox" id="land5" name="land5" value="Terraces">
            <label for="land5"> Terraces</label><br>
            <input type="checkbox" id="land6" name="land6" value="Rows">
            <label for="land6"> Rows</label><br>
            <input type="checkbox" id="land7" name="land7" value="Raised Beds">
            <label for="land7"> Raised Beds</label><br>
            <input type="checkbox" id="land8" name="land8" value="Floating Beds">
            <label for="land8"> Floating Beds</label><br>
            <input type="checkbox" id="land8" name="land8" value="Canals">
            <label for="land8"> Canals</label><br>
            <input type="checkbox" id="land8" name="land8" value="Walls">
            <label for="land8"> Walls</label><br>
            <input type="checkbox" id="land8" name="land8" value="n/a">
            <label for="land8"> n/a</label><br>
          </div>
        </t>
        <f href="#">Urban Integration:</f>
        <t href="#">
          <!--<input type="checkbox" id="int" name="int" value="all">-->
          <!--<label for="int"> All</label><br>-->
          <input type="checkbox" id="int1" name="int1" value="Integrated with Natural System" class="filter">
          <label for="int1"> Integrated with Natural System</label><br>
          <input type="checkbox" id="int2" name="int2" value="Squeeze in Urban Gaps" class="filter">
          <label for="int2"> Squeeze in Urban Gaps</label><br>
          <button class="button button2">more urban integration filters &emsp; <i class="fa fa-caret-down"></i></button>
          <div class="dropdown-container">
            <input type="checkbox" id="int3" name="int3" value="Accompany Domestic Lots">
            <label for="int3"> Accompany Domestic Lots</label><br>
            <input type="checkbox" id="int4" name="int4" value="Discrete Zone">
            <label for="int4"> Discrete Zone</label><br>
            <input type="checkbox" id="int8" name="int8" value="n/a">
            <label for="int8"> n/a</label><br>
          </div>
        </t>
        <button id="submit" class="submit">Submit</button><br>
      </div>
    </div>
    
    <!-- Page content -->
    <div class="main"></div>
    
    <head>
      <meta charset="utf-8">
      <title>Display a map on a webpage</title>
      <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
      <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
      <link href="https://api.mapbox.com/mapbox-gl-js/v2.3.0/mapbox-gl.css" rel="stylesheet">
      <script src="https://api.mapbox.com/mapbox-gl-js/v2.3.0/mapbox-gl.js"></script>
      <script src="https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.js"></script>
      <link href='./style.css'rel='stylesheet'>
    </head>
    
    <body>
      
      <div id="map"></div>
      <script src='https://code.jquery.com/jquery-1.11.0.min.js'></script>
      
      <script>
      
      /* Get all elements with class="close" */
      var closebtns = document.getElementsByClassName("close");
      var i;
      /* Loop through the elements, and hide the parent, when clicked on */
      for (i = 0; i < closebtns.length; i++) {
        closebtns[i].addEventListener("click", function() {
          this.parentElement.style.display = 'none';
        });
      }
      
      /* Loop through all dropdown buttons to toggle between hiding and showing its
      dropdown content - This allows the user to have multiple dropdowns without any
      conflict */
      var dropdown = document.getElementsByClassName("button");
      var i;
      for (i = 0; i < dropdown.length; i++) {
        dropdown[i].addEventListener("click", function() {
          this.classList.toggle("active");
          var dropdownContent = this.nextElementSibling;
          if (dropdownContent.style.display === "block") {
            dropdownContent.style.display = "none";
          } else {
            dropdownContent.style.display = "block";
          }
        });
      }
      
      // Mapbox access token and style ID
      mapboxgl.accessToken = 'pk.eyJ1Ijoic2phZnJvdWRpIiwiYSI6ImNra2VibWp0azB5azUyb256dHlpaHRtNDQifQ.LBpfWLTC701RZ51wpR_E9A';
      var bounds = [[-155, -50],[165, 80]];
      var map = new mapboxgl.Map({
        container: 'map', // container id
        style: 'mapbox://styles/sjafroudi/ckkebwmd4094i17rvfpitb0pz', // style URL
        center: [-16,30], // starting position [lng, lat] 20,0
        zoom: 1.5, // starting zoom 0.2
        maxBounds: bounds
      });
      
      map.on('style.load', function() {
        // Always add the same custom soruces and layers after a style change
        // Load markers
        map.loadImage('https://raw.githubusercontent.com/sjafroudi/UAH/main/images/mapbox-marker-icon-20px-red.png', function (error, image){
          if (error) throw error;
          map.addImage('icon', image);
        });
        // DATA: Site boundaries (i.e., Central Experimental Farm, Five Acre Farm)
        map.addSource('data', {
          type: 'geojson',
          data: 'https://raw.githubusercontent.com/sjafroudi/UAH/main/uahData_withLists.geojson'
        });
        
        // line
        map.addLayer({
          'id': 'boundary',
          'type': 'line',
          'source': 'data',
          'layout': {
            'visibility': 'visible'
          },
          'paint': {
            'line-color': '#959ba0',
            'line-width': 1
          },
          "filter": ["==", "$type", "Polygon"]
        });
        // fill multi polygons
        map.addLayer({
          'id': 'multiPolygonFill',
          'type': 'fill',
          'source': 'data',
          'layout': {
            'visibility': 'visible'
          },
          'paint': {
            'fill-color': 'red',
            'fill-outline-color': '#9b9ba0',
            'fill-opacity': [
              "interpolate", ["linear"], ["zoom"],
              5, 0.5,
              15, 0
            ]
          },
          "filter": ["==", "layerType", "UAHsystem"]
        });
        // fill
        map.addLayer({
          'id': 'boundaryFill',
          'type': 'fill',
          'source': 'data',
          'layout': {
            'visibility': 'visible'
          },
          'paint': {
            'fill-color': '#9b9ba0',
            'fill-outline-color': '#9b9ba0',
            'fill-opacity': 0.05
          },
          "filter": ["==", "$type", "Polygon"]
        });
        // marker
        map.addLayer({
          'id':'site',
          'type': 'symbol',
          'source': 'data',
          'layout': {
            'visibility': 'visible',
            'icon-allow-overlap': true,
            'icon-image': 'icon',
            'icon-size': 0.7
          },
          "filter": ["==", "$type", "Point"]
        });
        
        
        
      });
      
      // Switch basemap
      var layerList = document.getElementById('menu');
      var inputs = layerList.getElementsByTagName('input');
      function switchLayer(layer) {
        var layerId = layer.target.id;
        map.setStyle('mapbox://styles/' + layerId);
      }
      for (var i = 0; i < inputs.length; i++) {
        inputs[i].onclick = switchLayer;
      }
      
      // Create popup variable
      var popup = new mapboxgl.Popup({
        closeButton: true,
        closeOnClick: true
      });
      
      // Element variable for long form fact sheet
      var sideNav = document.getElementById("sidenavFact");
      var sideNavMain = document.getElementById("sidenav");
      var closeBtn = document.getElementById("close");
      
      // Popup event
      map.on('click', 'site', function(e) {
        var coordinates = e.features[0].geometry.coordinates;
        var site = e.features[0].properties.site;
        var location = e.features[0].properties.location;
        var size = e.features[0].properties.size;
        var heritageStatus = e.features[0].properties.heritageStatus;
        popup.setLngLat(coordinates);
        popup.setHTML('<div class="popup"><p class="twentysixpoint"><t href="#">' + site + '</t><br><br>' +
        "Location: " + location + '<br>' +
        "Size: " + size + '<br>' +
        "Heritage Status: " + heritageStatus + '<br></p></div>' +
        '<button class="button button2" onclick="myFunction()" id="myBtn"><t href="#">' +
        "View full fact sheet" + '</button><button class="button button2" id="flyTo">' +
        "Zoom to site" + '</t></button>');
        popup.addTo(map);
        
        // Fly To event
        var fly = document.getElementById("flyTo");
        fly.addEventListener('click', function(e) {
          if (site === "Dachas") {
            map.flyTo({
              center: coordinates,
              zoom: 6.7,
              speed: 1.2,
              curve: 1.42,
            });
          }
          else {
            map.flyTo({
              center: coordinates,
              zoom: 9,
              speed: 1.2,
              curve: 1.42,
            });
          }
        });
      });
      
      map.on('click', 'site', function(e) {
        var coordinates = e.features[0].geometry.coordinates;
        var site = e.features[0].properties.site;
        var location = e.features[0].properties.location;
        var size = e.features[0].properties.size;
        var heritageStatus = e.features[0].properties.heritageStatus;
        var geogAndClimate = e.features[0].properties.geogAndClimate;
        var integration = e.features[0].properties.integration;
        var mainProducts = e.features[0].properties.mainProducts;
        var operationScale = e.features[0].properties.operationScale;
        var cultivationSystem = e.features[0].properties.cultivationSystem;
        var history = e.features[0].properties.history;
        var heritage = e.features[0].properties.heritage;
        var stakeholders = e.features[0].properties.stakeholders;
        var customers = e.features[0].properties.customers;
        var risks = e.features[0].properties.risks;
        var incentives = e.features[0].properties.incentives;
        
        var title = document.createElement('strong');
        sideNav.style.marginTop = "10px";
        sideNav.style.marginRight = "30px";
        title.style.fontSize = "x-large";
        title.style.fontWeight = "300";
        title.textContent = site;
        
        var locationFS = document.createElement('p');
        locationFS.innerHTML = '<b>Location: </b>' + location;
        locationFS.style.fontWeight = "200";
        
        var sizeFS = document.createElement('p');
        sizeFS.innerHTML = '<b>Size:  </b>' + size;
        
        var heritageStatusFS = document.createElement('p');
        heritageStatusFS.innerHTML = '<b>Heritage Status:  </b>' + heritageStatus;
        
        var geogAndClimateFS = document.createElement('p');
        geogAndClimateFS.innerHTML = '<b>Geography and Climate:  </b>' + geogAndClimate;
        
        var integrationFS = document.createElement('p');
        integrationFS.innerHTML = '<b>Urban Integration:  </b>' + integration;
        
        var mainProductsFS = document.createElement('p');
        mainProductsFS.innerHTML = '<b>Main Products:  </b>' + mainProducts;
        
        var operationScaleFS = document.createElement('p');
        operationScaleFS.innerHTML = '<b>Scale of Operation:  </b>' + operationScale;
        
        var cultivationSystemFS = document.createElement('p');
        cultivationSystemFS.innerHTML = '<b>Cultivation System:  </b>' + cultivationSystem;
        
        var historyFS = document.createElement('p');
        historyFS.innerHTML = '<b>History:  </b>' + history;
        
        var heritageFS = document.createElement('p');
        heritageFS.innerHTML = '<b>Heritage:  </b>' + heritage;
        
        var stakeholdersFS = document.createElement('p');
        stakeholdersFS.innerHTML = '<b>Stakeholders:  </b>' + stakeholders;
        
        var customersFS = document.createElement('p');
        customersFS.innerHTML = '<b>Customers:  </b>' + customers;
        
        var risksFS = document.createElement('p');
        risksFS.innerHTML = '<b>Risks:  </b>' + risks;
        
        var incentivesFS = document.createElement('p');
        incentivesFS.innerHTML = '<b>Current Incentives:  </b>' + incentives;
        
        var emptySpace = document.createElement('p');
        emptySpace.innerHTML = ' ';
        
        
        sideNav.innerHTML = "";
        sideNav.appendChild(closeBtn);
        sideNav.appendChild(title);
        sideNav.appendChild(locationFS);
        sideNav.appendChild(sizeFS);
        sideNav.appendChild(heritageStatusFS);
        sideNav.appendChild(geogAndClimateFS);
        sideNav.appendChild(integrationFS);
        sideNav.appendChild(mainProductsFS);
        sideNav.appendChild(operationScaleFS);
        sideNav.appendChild(cultivationSystemFS);
        sideNav.appendChild(historyFS);
        sideNav.appendChild(heritageFS);
        sideNav.appendChild(stakeholdersFS);
        sideNav.appendChild(customersFS);
        sideNav.appendChild(risksFS);
        sideNav.appendChild(incentivesFS);
        sideNav.appendChild(emptySpace);
        sideNav.style.display = 'none';
        
      });
      
      function displayFS() {
        sideNav.style.display = "block";
        closeBtn.style.display = "block";
      }
      
      function myFunction() {
        if (sideNav.style.display === "block") {
          displayFS();
        } else {
          displayFS();
        }
      }
      
      function closeFS() {
        sideNav.style.display = "none";
        sideNav.innerHTML = ""; //remove all child elements inside of myDiv
        closeBtn.style.display === "block";
      }
      
      function openFS() {
        sideNav.style.display = "block";
      }
      
      function closeFunction() {
        if (closeBtn.style.display === "block") {
          closeFS();
        } else {
          openFS();
        }
      }
      
      // Cursor Style specs
      map.on('mouseenter', 'site', function () {
        map.getCanvas().style.cursor = 'pointer';
      });
      map.on('mouseleave', 'site', function() {
        map.getCanvas().style.cursor = '';
      });
      map.setLayerZoomRange('site', 0, 24);
      
      // Side panel catalogue --> fly to clicked site
      function flyToSiteCentral(){
        map.flyTo({
          center: [-75.709121, 45.387436],
          zoom: 12,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteDowling() {
        map.flyTo({
          center: [-93.207171, 44.932443],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteFenway(){
        map.flyTo({
          center: [-71.092980, 42.345834],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteFive(){
        map.flyTo({
          center: [-123.945692, 49.142222],
          zoom: 16,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteGlamorgan(){
        map.flyTo({
          center: [-123.426182, 48.658272],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteLondon(){
        map.flyTo({
          center: [-123.151921, 49.114599],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteNewman(){
        map.flyTo({
          center: [-123.395755, 48.601757],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteUBC(){
        map.flyTo({
          center: [-123.237301, 49.249697],
          zoom: 12,
          speed: 1.2,
          curve: 1.42,
        });
      }
      
      function flyToSiteChinampas(){
        map.flyTo({
          center: [-99.079256, 19.271650],
          zoom: 12,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSitePilar(){
        map.flyTo({
          center: [-89.155278, 17.256667],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteBude(){
        map.flyTo({
          center: [6.128928, 46.224855],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteCan(){
        map.flyTo({
          center: [2.157593, 41.445698],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteJucker(){
        map.flyTo({
          center: [8.773031, 47.343785],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteHuerta(){
        map.flyTo({
          center: [-0.376282, 39.471715],
          zoom: 10,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteVia(){
        map.flyTo({
          center: [6.121407, 50.72091],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteKnoblauchsland(){
        map.flyTo({
          center: [11.031397, 49.505310],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteSant(){
        map.flyTo({
          center: [12.412319, 45.457120],
          zoom: 9,
          speed: 1.2,
          curve: 1.42,
        });
      }
      function flyToSiteDachas(){
        map.flyTo({
          center: [30.3609, 59.9311],
          zoom: 6.7,
          speed: 1.2,
          curve: 1.42,
        });
      }
      
    </script>
    
  </body>
  </html>
